DATA_BY_WEEK:
  with first_data as (
  select distinct on (command_id)
      command_id,
      floor(date_part('day', task_start - '2023-01-02') / 7)::int as week,
      task_success,
      pick_success,
      place_success,
      sku_name,
      wms_sku_id,
      picker_host,
      sku_weight_g,
      sku_dimensions_mm
  from scan_sku_agg
  where task_start > ${start_date}
      and task_start < ${end_date} 
  )
  
  select 
      week,
      picker_host,
      wms_sku_id,
      max(sku_name) as sku_name,
      max(sku_weight_g) as sku_weight_g,
      max(sku_dimensions_mm) as sku_dimensions_mm,
      sum(task_success::int) as task_success,
      sum(pick_success::int) as pick_success,
      sum(place_success::int) as place_success,
      count(task_success) as task_total,
      count(pick_success) as pick_total,
      count(place_success) as place_total
  from first_data
  group by 
      week,
      picker_host,
      wms_sku_id

DATA_TOTAL:
  with first_data as (
  select distinct on (command_id)
      command_id,
      task_success,
      pick_success,
      place_success,
      sku_name,
      wms_sku_id,
      picker_host,
      sku_weight_g,
      sku_dimensions_mm
  from scan_sku_agg
  where task_start > ${start_date}
      and task_start < ${end_date} 
  )
  
  select 
      picker_host,
      wms_sku_id,
      max(sku_name) as sku_name,
      max(sku_weight_g) as sku_weight_g,
      max(sku_dimensions_mm) as sku_dimensions_mm,
      sum(task_success::int) as task_success,
      sum(pick_success::int) as pick_success,
      sum(place_success::int) as place_success,
      count(task_success) as task_total,
      count(pick_success) as pick_total,
      count(place_success) as place_total
  from first_data
  group by 
      picker_host,
      wms_sku_id


SKUS:
  select distinct on (wms_sku_id::int)
      * 
  from sku
  order by 
      wms_sku_id::int,
      version desc
